\chapter{Análisis}\label{chap:analysis}

Este capítulo describirá la solución propuesta y está dividido en tres
secciones. La primera (\sectionref{description}), hará una breve descripción del
proyecto. La segunda (\sectionref{requirements}), describirá los requisitos del
sistema desarrollado. Por último, la tercera (\sectionref{usecases}),
especificará los diferentes casos de uso del sistema.

\section{Descripción del proyecto}\label{sec:description}

El objetivo de este proyecto es rehacer el \gls{compiler} utilizado por CREATOR,
para intentar solucionar la mayoría de los problemas que presenta el compilador
utilizado actualmente. Este compilador será utilizado principalmente por
estudiantes para programar en \gls{assembly}. Debido a esto, es fundamental que
el compilador genere buenos mensajes de error que orienten a los estudiantes en
su aprendizaje de este lenguaje.

El compilador actual se creó en muy poco tiempo, y, a causa de esto, su
funcionamiento está poco documentado y es difícil de modificar para corregir
problemas y añadir nuevas funcionalidades. Además, tiene problemas de
rendimiento al aumentar el tamaño de los programas.
% TODO: mencionar mejores errores que de los de GNU as?

Debido a esto, se propone crear un nuevo compilador que solucione estos
problemas. Este nuevo compilador también mejorará los mensajes de error para
ayudar a los estudiantes en su aprendizaje del lenguaje. Además, añadirá nuevas
funcionalidades no soportadas en el compilador actual, que facilitarán el uso de
CREATOR como entorno de pruebas para nuevas arquitecturas.

\section{Requisitos}\label{sec:requirements}

Esta sección contiene la especificación de los requisitos del sistema a
desarrollar. Para esta especificación de requisitos se han seguido las prácticas
recomendadas por IEEE \parencite{requirementsIEEE}. Estas prácticas indican que
una buena especificación de requisitos debe explicar la funcionalidad del
software, los requisitos de rendimiento, las interfaces externas, otros
atributos, y restricciones de diseño.

\noindent
Además, la especificación de requisitos debe ser:

\begin{itemize}
    \item \textbf{No ambigua}: Los requisitos tienen una única interpretación.
    \item \textbf{Completa}: Incluye todos los requisitos relevantes.
    \item \textbf{Verificable}: Existe un proceso finito y no costoso que permite
    comprobar que el sistema cumple con todos los requisitos.
    \item \textbf{Consistente}: No existe ningún conjunto de requisitos contradictorios
    entre sí.
    \item \textbf{Modificable}: La estructura y estilo de los requisitos permite que
    cualquier cambio necesario se haga de forma fácil, completa, y consistente.
    \item \textbf{Trazable}: El origen de cada requisito es claro, y facilita la
    referencia de cada requisito en otras etapas.
    \item \textbf{Clasificada}: Los requisitos deben estar clasificados según su
    importancia y estabilidad.
\end{itemize}

Para realizar la especificación de requisitos, se parte de los requisitos de
usuario (\subsectionref{user-requirements}), que contienen una especificación
informal de las necesidades del cliente y lo que este espera del producto. A
partir de estos, se crean los requisitos de software
(\subsectionref{software-requirements}). Estos requisitos guían el proceso de
diseño, aportando información sobre las funcionalidades del sistema y cualquier
otra característica adicional.

% ╔════════════════════════════════════════════════════════════════════════════╗
% ║                           Requisitos de usuario                            ║
% ╚════════════════════════════════════════════════════════════════════════════╝

\subsection{Requisitos de usuario}\label{subsec:user-requirements}

Esta sección contiene el listado detallado de los requisitos de usuario. Estos
requisitos explican la funcionalidad principal del sistema y las restricciones
que este debe cumplir para ser aceptado por el cliente.

\noindent
Estos requisitos se pueden dividir en dos tipos:

\begin{itemize}
    \item \textbf{Capacidad}: Representa una funcionalidad que el sistema debe tener.
    \item \textbf{Restricción}: Representa una condición que el sistema debe cumplir.
\end{itemize}

Cada requisito se identificará con un ID con el formato RU-XX-YY. XX
representará el tipo del requisito, pudiendo tomar los valores CA para capacidad
y RE para restricción; mientras que YY representará un código numérico incremental
dentro de cada tipo que empezará en 1.

La \tableref{ur-template} contiene la plantilla que se utilizará para la
especificación de los requisitos de usuario.

\printureqtemplate{UR-XX-YY}

\newcounter{i}

% ───────────────────────────────── Capacidades ───────────────────────────────

\setcounter{i}{1}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=h,pd=h,s=nc,v=m}
    El sistema debe soportar todas las funcionalidades soportadas en el
    \gls{compiler} actual.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    El sistema debe permitir especificar la \gls{ISA} a utilizar.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=m,pd=l,s=nc,v=h}
    El sistema debe permitir especificar la cadena utilizada como prefijo de los
    comentarios de línea.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=m,pd=l,s=nc,v=h}
    El sistema debe permitir utilizar cualquier cantidad de etiquetas en una
    \gls{sentence}.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=h,pd=h,s=c,v=m}
    El sistema debe permitir referenciar etiquetas definidas más adelante en el
    código \glsdisp{assembly}{ensamblador}.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=m,pd=m,s=nc,v=h}
    El sistema debe permitir utilizar etiquetas como valores de las \glspl{data directive}.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=m,pd=m,s=c,v=h}
    El sistema debe permitir evaluar y utilizar \glspl{expression} con valores
    constantes.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    El sistema debe permitir definir múltiples \glspl{instruction} con el mismo
    nombre, y utilizar su sintaxis y el tamaño de los argumentos (en bits) para
    seleccionar la correcta durante la \gls{compilation} de un \gls{program}
    \glsdisp{assembly}{ensamblador}.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=h,pd=h,s=c,v=l}
    El sistema debe tener buenos mensajes de error.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-CA-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    El sistema debe permitir utilizar números enteros de cualquier tamaño para
    las direcciones de \gls{memory} y valores de las \glspl{expression}.
\end{userReq}
\stepcounter{i}

% ──────────────────────────────── Restricciones ──────────────────────────────

\setcounter{i}{1}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    El formato de definición de la \gls{ISA} debe ser el utilizado
    actualmente en CREATOR.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    La \gls{API} de entrada y salida del sistema debe ser la utilizada
    actualmente en CREATOR.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    El sistema se tiene que poder ejecutar en los navegadores soportados
    actualmente por CREATOR: Google Chrome 70+, Mozilla Firefox 60+, y Safari
    12+
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=m,pd=m,s=nc,v=h}
    El sistema se tiene que poder ejecutar en Node.js
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    El sistema debe tener una \gls{API} para \gls{JS}.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    El sistema tiene que ser \gls{FOSS}.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=h,pd=h,s=c,v=m}
    El sistema tiene que utilizar la sintáxis del \gls{assembler} GNU as para
    los \glspl{program} \glsdisp{compilation}{compilados}.
\end{userReq}
\stepcounter{i}

\begin{userReq}{RU-RE-\padtwo{i}}{pc=m,pd=m,s=vi,v=l}
    El sistema tiene que ser rápido. % TODO: más explicación
\end{userReq}
\stepcounter{i}

\FloatBarrier

% ╔════════════════════════════════════════════════════════════════════════════╗
% ║                           Requisitos de software                           ║
% ╚════════════════════════════════════════════════════════════════════════════╝

\subsection{Requisitos de software}\label{subsec:software-requirements}

Esta sección contiene el listado detallado de los requisitos de software. Estos
requisitos se han creado a partir de los requisitos de usuario descritos en la
sección anterior, y definen las características del sistema.

\noindent
Estos requisitos se pueden dividir en dos tipos:

\begin{itemize}
    \item \textbf{Funcional}: Define las funcionalidades y características del
    software.
    \item \textbf{No funcional}: Define una condición que el software debe cumplir.
\end{itemize}

Cada requisito se identificará con un ID con el formato RS-XX-YY. XX
representará el tipo del requisito, pudiendo tomar los valores F para funcional
y NF para no funcional; mientras que YY representará un código numérico incremental
dentro de cada tipo que empezará en 1.

La \tableref{sr-template} contiene la plantilla que se utilizará para la
especificación de los requisitos de software.

\printsreqtemplate{RS-XX-YY}

% ───────────────────────────────── Funcionales ───────────────────────────────

\setcounter{i}{1}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe permitir \glsdisp{compilation}{compilar} \glspl{instruction}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe permitir \glsdisp{compilation}{compilar} \glspl{pseudo-instruction}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar las siguientes \glspl{directive}: cambiar el tipo
    de la sección actual, declarar símbolos globales, y \glspl{data directive}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar los siguientes tipos de secciones: datos e
    instrucciones.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar las siguientes \glspl{data directive}: reservar
    espacio, cadenas de caracteres, números enteros, números decimales, y
    alineamiento de la \gls{data memory}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar \glspl{data directive} de cadenas de
    caracteres terminadas y no terminadas en un \gls{null byte}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar \glspl{data directive} de números enteros con los
    siguientes tamaños: byte, media \gls{word}, \gls{word}, y doble \gls{word}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar \glspl{data directive} de números decimales con el
    formato IEEE 745 de precisión simple (binary32) y doble (binary64).
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar \glspl{data directive} de alineamiento a bytes y a
    potencias de 2.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-01}
    El sistema debe soportar bibliotecas. % TODO: explicar cuando entienda cómo funcionan
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-CA-02}
    El sistema debe permitir especificar la \gls{ISA} a utilizar.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=m,pd=l,s=nc,v=h}
    {RU-CA-03}
    El sistema debe permitir especificar la cadena utilizada como prefijo de los
    comentarios de línea.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=m,pd=l,s=nc,v=h}
    {RU-CA-04}
    El sistema debe permitir utilizar cualquier cantidad de etiquetas en una
    \gls{sentence}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=c,v=m}
    {RU-CA-05}
    El sistema debe permitir referenciar etiquetas definidas más adelante en el
    código \glsdisp{assembly}{ensamblador}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=m,pd=m,s=nc,v=h}
    {RU-CA-06, RU-CA-07}
    El sistema debe permitir evaluar \glspl{expression} con los siguientes tipos
    de valores constantes: números enteros, números decimales, y etiquetas.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=m,pd=m,s=c,v=h}
    {RU-CA-07}
    El sistema debe permitir utilizar \glspl{expression} como \glspl{immediate}
    de las \glspl{instruction} y \glspl{pseudo-instruction}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=m,pd=m,s=nc,v=h}
    {RU-CA-07}
    El sistema debe permitir utilizar \glspl{expression} como valores de las
    \glspl{data directive} de reservar espacio, números enteros y decimales, y
    alineamiento.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-CA-08}
    El sistema debe permitir definir múltiples \glspl{instruction} con el mismo
    nombre, y utilizar su sintáxis y el tamaño de los argumentos (en bits) para
    seleccionar la correcta durante la \gls{compilation} de un \gls{program}
    \glsdisp{assembly}{ensamblador}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=h,s=c,v=m}
    {RU-CA-09}
    Los mensajes de error del sistema deben contener, al menos: posición exacta
    del error (línea y columna), mensaje de error, segmento de código con el
    error resaltado, e información adicional relevante como motivo del error u
    posible solución.
\end{softwareReq}
\stepcounter{i}

%\begin{softwareReq}{RS-F-\padtwo{i}}{pc=l,pd=l,s=c,v=h}
%    {RU-CA-09}
%    Los mensajes de error del sistema que se refieran a identificadores no
%    definidos deben contener el identificador definido más similar según la
%    \gls{edit-distance}
%    del error (línea y columna), mensaje de error, segmento de código con el
%    error resaltado, e información adicional relevante.
%\end{softwareReq}
%\stepcounter{i}

\begin{softwareReq}{RS-F-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-CA-10}
    El sistema debe permitir utilizar números enteros de cualquier tamaño para
    las direcciones de \gls{memory} y valores de las \glspl{expression}.
\end{softwareReq}
\stepcounter{i}

% ──────────────────────────────── No funcionales ────────────────────────────────

\setcounter{i}{1}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-RE-01}
    El formato de definición de la \gls{ISA} debe ser el utilizado
    actualmente en CREATOR.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-RE-01}
    La definición de la sintáxis de las instrucciones debe estar contenida en la
    \gls{ISA}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=h,s=nc,v=h}
    {RU-RE-02}
    La \gls{API} de entrada y salida del sistema debe ser la utilizada
    actualmente en CREATOR.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-RE-03}
    El sistema se tiene que poder ejecutar en Google Chrome 70+
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-RE-03}
    El sistema se tiene que poder ejecutar en Mozilla Firefox 60+
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-RE-03}
    El sistema se tiene que poder ejecutar en Safari 10+
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=m,pd=m,s=nc,v=h}
    {RU-RE-04}
    El sistema se tiene que poder ejecutar en Node.js
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-RE-05}
    El sistema debe tener una \gls{API} para \gls{JS}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-RE-06}
    El sistema tiene que utilizar una licencia \gls{FOSS}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=m,s=nc,v=h}
    {RU-RE-06}
    El código fuente del sistema tiene ser público.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=h,pd=h,s=c,v=m}
    {RU-RE-07}
    El sistema tiene que utilizar la sintáxis del \gls{assembler} GNU as para
    los \glspl{program} \glsdisp{compilation}{compilados}.
\end{softwareReq}
\stepcounter{i}

\begin{softwareReq}{RS-NF-\padtwo{i}}{pc=m,pd=m,s=vi,v=l}
    {RU-RE-08}
    El sistema tiene que ser rápido. % TODO: más explicación
\end{softwareReq}
\stepcounter{i}

\FloatBarrier

% ╔════════════════════════════════════════════════════════════════════════════╗
% ║                                Trazabilidad                                ║
% ╚════════════════════════════════════════════════════════════════════════════╝

\subsection{Trazabilidad}\label{subsec:trazability}

La matriz de trazabilidad permite verificar que todos los requisitos de usuario
están cubiertos por al menos un requisito de software. Como se puede ver, todos
los requisitos de capacidad están cuviertos por los requisitos funcionales
(\tableref{trazability-ca-f}), y todos los requisitos de restricción están
cuviertos por los requisitos no funcionales (\tableref{trazability-re-nf})

\traceabilityTable{trazability-ca-f}
    {^RS\37-F}{^RU\37-CA}
    {Trazabilidad entre los requisitos de capacidad y los requisitos funcionales}

\traceabilityTable{trazability-re-nf}
    {^RS\37-NF}{^RU\37-RE}
    {Trazabilidad entre los requisitos de capacidad y los requisitos funcionales}

\FloatBarrier

\section{Casos de uso}\label{sec:usecases}

El modelo de casos de uso UML \parencite{UMLSpec}, mostrado en la \figureref{use_cases} representa las
acciones que el usuario puede realizar con el sistema. Cabe destacar que, como
el propósito del sistema es muy específico, la cantidad de casos de uso es
bastante limitada.

\drawiosvgfigure[0.55]{use_cases}{Modelo de casos de uso}

Cada requisito se identificará con un ID con el formato CU-X, donde X
representará un código numérico incremental que empezará en 1. La
\tableref{uc-template} contiene la plantilla que se utilizará para la
especificación de cada uno de los casos de uso.

\printuctemplate{CU-XX}

\setcounter{i}{1}

% TODO: deberían estar formulados como algo que hace un usuario en la interfaz o
% algo que envía CREATOR como programa?

\begin{useCase}{UC-\arabic{i}}
    {Cargar \gls{ISA}} % Nombre
    {Usuario} % Usuario
    {Cargar la \gls{ISA} a utilizar durante la \gls{compilation} de un \glsdisp{assembly}{ensamblador}} % Description
    {El usuario debe tener la \gls{ISA} correctamente definida en una cadena de caracteres} % Pre-condición
    {La \gls{ISA} está cargada y disponible para realizar la compilación} % Post-condición
    \begin{enumerate}[leftmargin=*, topsep=0pt, noitemsep]
        \item El usuario entrega una cadena de caracteres con la
        \gls{ISA} a la \gls{API} de cargar \gls{ISA}.
    \end{enumerate}
\end{useCase}
\stepcounter{i}

\begin{useCase}{UC-\arabic{i}}
    {\glsdisp{compilation}{Compilar} \gls{program}} % Nombre
    {Usuario} % Usuario
    {\glsdisp{compilation}{Compilar} un \gls{program} para su posterior ejecución en CREATOR} % Description
    {La \gls{ISA} debe estar cargada en el \gls{compiler}} % Pre-condición
    {El \gls{program} está compilado y disponible su ejecución en CREATOR} % Post-condición
    \begin{enumerate}[leftmargin=*, topsep=0pt, noitemsep]
        \item El usuario entrega una cadena de caracteres con el \gls{program}
        a la \gls{API} de \glsdisp{compilation}{compilar} \gls{program}.
    \end{enumerate}
\end{useCase}
\stepcounter{i}
